---
title: "Guided Tidy Tuesday - Voice interactions in Star Trek"
author: "Julia MÃ¼ller"
date: "24 8 2021"
output: html_document
---


Welcome!


# Exploring the data

Download from the TidyTuesday Github:
https://github.com/rfordatascience/tidytuesday/blob/master/data/2021/2021-08-17/readme.md

```{r}
library(tidyverse)

computer <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-08-17/computer.csv')
```

```{r}
head(computer, 20)

str(computer)
```

Questions:
- name - what does that mean? Why is it a number?
  ID - ignore
- Duplicates in line
  
- Line vs interaction?
  
- type vs pri_type
  
- domain vs subdomain
  
- nv_resp, is_fed, error
  
Also: data types - what do we need to convert?

```{r}
computer %>% 
  select(line, interaction)
```

Make sure to check out the codebook with much more information on what the categories mean here:
http://www.speechinteraction.org/TNG/TeaEarlGreyHotDatasetCodeBook.pdf


## Convert to factors
```{r}
str(computer)

summary(as_factor(computer$char))

computer <- computer %>% 
  mutate(across(c(char, type, pri_type, domain, sub_domain), as_factor))
```


# Analysis

## Who's the most talkative person?
```{r}
computer %>% 
  filter(char_type == "Person") %>% 
  count(char, sort = TRUE)
```


## Tea, Earl Grey, hot - how often?
How often is tea mentioned?

```{r}
computer %>% 
  filter(str_detect(line, "\\b[Tt]ea\\b"))
```


# Graphs
- Are human characters more likely than the computer character(s) to do Conversational speech types?
- Breakdown type/pri_type by person/by computer

## Primary type/type computer vs person
```{r}
computer %>% 
  mutate(type = str_to_title(type)) %>% 
  #distinct(interaction, pri_type, .keep_all = TRUE) %>% 
  group_by(char_type) %>% 
  count(type) %>% 
  mutate(type = fct_reorder(type, n)) %>% 
  ungroup() %>% 
  ggplot() +
  aes(x = type, y = n, fill = char_type) +
  geom_col(position = "dodge") +
  coord_flip() +
  facet_wrap(~ char_type, scales = "free") +
  theme_minimal() +
  theme(legend.position = "none")
```

## Type - people only
```{r}
library(trekcolors)

computer %>% 
  mutate(type = str_to_title(type)) %>%
  filter(char_type == "Person") %>% 
  count(type) %>% 
  mutate(type = fct_reorder(type, n),
         perc = round(n/sum(n) * 100, 2),
         perc_label = paste0(type, ": ", perc, "%"),
         place = if_else(perc >= 30, 1, 0),
         text_col = if_else(perc >= 30, "white", "black")) %>% 
  ggplot() +
  aes(x = type, y = perc, fill = type) +
  geom_col() +
  geom_text(aes(label = perc_label,
                hjust = place)) +
  coord_flip() +
  theme_void() +
  scale_fill_trek("klingon", reverse = TRUE) +
  theme(legend.position = "none",
        plot.title = element_text()) +
  labs(title = "Interaction types",
       subtitle = "Enterprise Computer only")
```



