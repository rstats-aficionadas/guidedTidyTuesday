---
title: "Guided Tidy Tuesday: Giant pumpkins, watermelons & tomatoes"
author: "Kyla McConnell & Julia MÃ¼ller"
date: "27 10 2021"
output: html_document
---

```{r}
library(tidyverse)

pumpkins <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-19/pumpkins.csv')
```

More info on the data:
https://github.com/rfordatascience/tidytuesday/blob/master/data/2021/2021-10-19/readme.md

```{r}
head(pumpkins)
```

```{r}
pumpkins <- pumpkins %>% 
  mutate(
    across(c(weight_lbs, est_weight, ott, pct_chart, place), as.numeric),
    across(c(state_prov, country), as.factor)
  )
```

```{r}
pumpkins <- pumpkins %>% 
  separate(id, c("year", "type"), sep="-")
```

```{r}
pumpkins %>% 
  filter(type == "W" & country == "United States") %>% 
  group_by(state_prov) %>% 
  summarize(weight_lbs = max(weight_lbs)) %>% 
  top_n(15)
```

